//
// Created by lucas on 23/11/25.
//
#pragma once
#include <cmath>
#include <Eigen/Dense>

inline std::span<const double> occ_vec_span(occ::Vec& v)
{
    return std::span<const double>(v.data(), v.size());
}

inline std::span<const double> eigen_vec_span(const Eigen::VectorXd& v)
{
    return std::span<const double>(v.data(), v.size());
}


enum class ORB : int {
    S = 0,
    P = 1,
    D = 2,
    F = 3,
    G = 4,
    H = 5,
};
namespace pure2cart {
    inline const Eigen::Matrix<double, 1, 1> matS {
        {  1.0,  },
    };

    inline const Eigen::Matrix<double, 3, 3> matP {
        { 1.0,  0.0,  0.0 }, // X
        { 0.0,  1.0,  0.0 }, // Y
        { 0.0,  0.0,  1.0 }, // Z
    };

    inline const Eigen::Matrix<double, 6, 5> matD {
        { -0.2886751345948129,  0.0,  0.0,  0.5,  0.0 },                // XX
        { -0.2886751345948129,  0.0,  0.0, -0.5,  0.0 },                // YY
        {  0.5773502691896257,  0.0,  0.0,  0.0,  0.0 },                // ZZ
        {  0.0,  0.0,  0.0,  0.0,  1.0 },                               // XY
        {  0.0,  1.0,  0.0,  0.0,  0.0 },                               // XZ
        {  0.0,  0.0,  1.0,  0.0,  0.0 },                               // YZ
    };

    inline const Eigen::Matrix<double, 10, 7> matF {
        {  0.0, -0.158113883008419,  0.0,  0.0,  0.0, -0.2041241452319315,  0.0 },  // XXX
        {  0.0,  0.0, -0.158113883008419,  0.0,  0.0,  0.0,  0.2041241452319315 },  // YYY
        {  0.2581988897471611,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0 },                // ZZZ
        {  0.0,  0.0, -0.158113883008419,  0.0,  0.0,  0.0, -0.6123724356957945 },  // XXY
        { -0.3872983346207417,  0.0,  0.0,  0.5,  0.0,  0.0,  0.0 },                // XXZ
        { -0.3872983346207417,  0.0,  0.0, -0.5,  0.0,  0.0,  0.0 },                // YYZ
        {  0.0, -0.158113883008419,  0.0,  0.0,  0.0,  0.6123724356957945,  0.0 },  // XYY
        {  0.0,  0.6324555320336759,  0.0,  0.0,  0.0,  0.0,  0.0 },                // XZZ
        {  0.0,  0.0,  0.6324555320336759,  0.0,  0.0,  0.0,  0.0 },                // YZZ
        {  0.0,  0.0,  0.0,  0.0,  1.0,  0.0,  0.0 },                               // XYZ
    };

    inline const Eigen::Matrix<double, 15, 9> matG {
        { 0.0633865691011321, 0.0, 0.0, -0.0944911182523068, 0.0, 0.0, 0.0, -0.125, 0.0 },
        { 0.0633865691011321, 0.0, 0.0, 0.0944911182523068, 0.0, 0.0, 0.0, -0.125, 0.0 },
        { 0.1690308509363523, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 },
        { 0.0, 0.0, 0.0, 0.0, -0.1889822365046136, 0.0, 0.0, 0.0, -0.5 },
        { 0.0, -0.4008918628686365, 0.0, 0.0, 0.0, -0.3535533905932737, 0.0, 0.0, 0.0 },
        { 0.0, 0.0, 0.0, 0.0, -0.1889822365046136, 0.0, 0.0, 0.0, 0.5 },
        { 0.0, 0.0, -0.4008918628686365, 0.0, 0.0, 0.0, 0.3535533905932737, 0.0, 0.0 },
        { 0.0, 0.5345224838248488, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 },
        { 0.0, 0.0, 0.5345224838248488, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 },
        { 0.1267731367322709, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.75, 0.0 },
        { -0.5070925528090568, 0.0, 0.0, 0.5669467095138409, 0.0, 0.0, 0.0, 0.0, 0.0 },
        { -0.5070925528090568, 0.0, 0.0, -0.5669467095138409, 0.0, 0.0, 0.0, 0.0, 0.0 },
        { 0.0, 0.0, -0.4008918628686365, 0.0, 0.0, 0.0, -1.0606601717798212, 0.0, 0.0 },
        { 0.0, -0.4008918628686365, 0.0, 0.0, 0.0, 1.0606601717798212, 0.0, 0.0, 0.0 },
        { 0.0, 0.0, 0.0, 0.0, 1.1338934190276817, 0.0, 0.0, 0.0, 0.0 },
    };
}

inline const std::array<Eigen::Map<const Eigen::MatrixXd>, 5> MappedMatrices = {{
        { pure2cart::matS.data(), 1, 1 },
        { pure2cart::matP.data(), 3, 3  },
        { pure2cart::matD.data(), 6, 5 },
        { pure2cart::matF.data(), 10, 7 },
        { pure2cart::matG.data(), 15, 9 },
    }};
